<style>
body {
  min-width:357px;
  overflow-x:hidden;
}

img {
  margin:5px;
  border:2px solid black;
  vertical-align:middle;
  width:46%;
  /*height:75px;*/
}
</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js" type="text/javascript"></script>
<script>
	
	function getResolution(){
		return screen.width+"x"+screen.height;
	}
	
	function urlDetailedToSpecific(url)
	{
		//detail; http://interfacelift.com/wallpaper_beta/details/1543/falls.html
		//specifi: http://interfacelift.com/wallpaper_beta/grab/02432_eldtic_1680x1050.jpg
		res=getResolution();
		url=url.replace("/details/","/grab/");
		url=url.replace(/\/(\w+)\.html$/, "_$1_"+res+".jpg");
		return url;
	}
	
	function urlToImg(url){
			// 
			// =>
			// <a href=""><img src=""></a>
			// 
			//http://interfacelift.com/wallpaper_beta/previews/02424_skypainting.jpg
			//http://interfacelift.com/wallpaper_beta/details/1543/falls.html
			ori=url;
		
			url=url.replace("/previews/",'/details/');
			url=url.replace(/_(\w+)\.jpg$/,'/$1.html');
			return "<a href=\""+url+"\" title=\""+url+"\"><img src=\""+ori+"\"></a>";

		}
	$(document).ready(function(){ 
		//begine
		
		
		$.getJSON("http://zhasm.com/cgi-bin/api/iw.py?jsoncallback=?.json", function(data){
			imgs=data.imgs;
			len=imgs.length;
			result="";
			
			for (i=0; i<len; i++)
			{
				result += urlToImg(imgs[i]);			
			}
			
			$("#images").html(result);
			
			var bestFit=0;
			
			//key press
			$("*").keydown(function(event){

			        if(event.keyCode=='16')
			        {	//16==shift, 17==control
					
						bestFit=1;				
			        }				
					
			   	});
			
			$("*").keyup(function(){
				bestFit=0;
			});
			
			$("a").click(function(event){
				url=$(this).attr("href");
				if(bestFit ==1)
			    {
					url=urlDetailedToSpecific(url);	
				}
				chrome.tabs.create({'url': url});
			}); //click ends
		
			//key press end;
			
			
		});
		//end
	});
</script>

<body>
	
	<div id="images"> 
	</div> 
 
</body>